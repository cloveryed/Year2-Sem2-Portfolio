# Malware Analysis: Static Analysis of Suspicious Executable

**Course:** Malware Analysis Tools and Techniques, Year 2 Sem 3  
**Objective:** Perform static analysis on a suspected malware sample to identify its characteristics, behavior, and potential threat level.  
**Tools Used:** PEview, BinText, Dependency Walker, HxD Hex Editor, CFF Explorer, ILSpy, VirusTotal  
**Key Skills:** PE file analysis, String extraction, Import/Export analysis, Hex editing, .NET reverse engineering  
**Sample:** `5771d1ddb22ecd1c9354ccf4566bf550` (MD5 hash)

### Basic Information!
- **File Type:** .NET executable (x86)
- **.NET Version:** 4.0
- **Compile Time:** 2023-07-17 07:32:40 UTC
- **Entry Point:** QLTV.Program.Main
- **VirusTotal Detection:** 15/70 engines detected as malicious

### PE Structure Analysis!
- **Sections:** .text, .rsrc, .reloc
- **Entry Point RVA:** 0007ADAE
- **Image Base:** 00400000
- **Notable:** No obvious packing detected

## Key Findings!

### Suspicious Strings Found
- **SQL Connection String:** `Data Source=QUYETTHANG;Initial Catalog=QLTV;Integrated Security=True`
- **Fake Metadata:** "Microsoft" as company name, generic version info
- **PDB Path:** `kDkb.pdb` (possible original project name)
- **Large Obfuscated Blocks:** "YRYRYR..." patterns
- **Embedded Executable:** MZ header found within file

### Import Analysis
- **mscoree.dll** - .NET runtime functions
- **kernel32.dll** - File operations, memory allocation
- **user32.dll** - GUI functions (MessageBoxW)
- **advapi32.dll** - Registry manipulation
- **urlmon.dll** - Network communication (URLOpenBlockingStreamW)

## Analysis Conclusions!

### Likely Malware Type: Data Stealer
1. **SQL Credential Harvesting** - Connection string suggests database targeting
2. **.NET Assembly** - Easy to decompile and analyze
3. **Network Capabilities** - URL opening functions indicate C2 communication
4. **Registry Interaction** - Potential persistence mechanisms
5. **Embedded Payload** - MZ header suggests secondary executable

### Indicators of Compromise
- **MD5:** 5771d1ddb22ecd1c9354ccf4566bf550
- **PDB Path:** kDkb.pdb
- **Fake Metadata:** Microsoft branding
- **SQL Target:** QUYETTHANG server, QLTV database

## Defensive Recommendations!
1. **Network Monitoring:** Watch for connections to unknown SQL servers
2. **File Detection:** Block/alert on files with similar hash or PDB paths
3. **.NET Monitoring:** Monitor unusual .NET assembly executions
4. **Registry Monitoring:** Watch for persistence attempts

## Assignment Document!
- [Full Analysis Report](./MATT_ASG.docx)
- [Analysis Screenshots](./screenshots/) *(if available)*
- [Tool Outputs](./tool-outputs/) *(if available)*

## Learning Outcomes!
- Hands-on static malware analysis skills
- PE file structure understanding
- .NET assembly analysis techniques
- IOC identification and documentation
- Professional malware analysis reporting
